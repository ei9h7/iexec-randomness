<!DOCTYPE html>
<html lang="en">

	<head>
			<meta charset="utf-8">
			<title>Decentralized Random Number Generator</title>
			<link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
			<link rel="stylesheet" type="text/css" href="./static/css/style.css"/>
	</head>

	<body>
		<div class="body-logo"></div>

		<header>
			<div class="header-wrapper">
				<h1 class="iexec-stroke">Decentralized Random Number Generator</h1>
				<h2 class="iexec-stroke">uint256 Edition</h2>

				<div class="header-body">
					<div class="source-logo iexec-stroke">
						<div>
							<h3 class="header-h3">Protected By</h3>
						</div>
						<a class="iexec-link" href="https://builders.intel.com/ai/membership/iexec" target="_blank">
						<img src="./static/img/intel-sgx.png" class="sgx-logo">
						</a>
					</div>

					<div class="source-logo iexec-stroke">
						<div>
							<h3 class="header-h3">Powered By</h3>
						</div>
						<a class="iexec-link" href="https://iex.ec" target="_blank">
						<img src="./static/img/iexec-white.png" class="iexec-logo">
						</a>
					</div>

					<div class="source-logo iexec-stroke">
						<div>
							<h3 class="header-h3">Secured By</h3>
						</div>
						<a class="iexec-link" href="https://sconedocs.github.io/dapps/" target="_blank">
						<img src="./static/img/scone.svg" class="scone-logo">
						</a>
					</div>
				</div>
			</div>
		</header>

		<main>
			<div class="main-wrapper">
				<div id="aboutContainer" class="about-display">
					<h3>cryptographically strong random numbers generated by an iExec Trusted Execution Environment (TEE) worker pool using iExec Confidential Computing</h3>
				</div>

				<h2>Recent Random Results</h2>
				<div id="tasksContainer">
					<h3>calling iExec API...</h3>
				</div>

				<h2>Request Randomness</h2>
				<div id="orderContainer">
					<div class="order-wrapper">
						<div id="web3Connect" class="connect-button connection-inactive">
							<span>Connect Web3 Wallet</span>
						</div>
						<div id="web3Status"></div>

						<div class="ipfs-info">
								<div class="input-container">
									<input id="ipfsButton" class="button task-block display-none" type="button" value="Initialize Remote Storage"  disabled onclick=""/>
									</div>
						</div>

						<div class="input-container">
							<h3 class="iexec-link" >Smart Contract Address</h3>
							<input type="text" id="userSmartContract" class="smart-contract-input" maxlength="42" value="0x0000000000000000000000000000000000000001">
							<h3>(or you can use any address to test app)</h3>
						</div>

						<div class="input-container">
								<input id="runTaskButton" class="button task-block" type="button" value="Run iExec Randomness Task" disabled onclick=""/>
						</div>

					</div>
				</div>

				<div id="usageContainer" class="about-display">
					<h3>
						To receive an iExec callback, your smart contract should inherit from <a class="iexec-link" href="https://github.com/iExecBlockchainComputing/iexec-doracle/blob/v5/contracts/IexecDoracle.sol" target="_blank">IexecDoracle</a> and <a class="iexec-link" href="https://github.com/iExecBlockchainComputing/iexec-solidity/blob/master/contracts/ERC1154/IERC1154.sol" target="_blank">IOracleConsumer</a>.
						Define the required function <i>receiveResult</i> to receive the iExec callback after the iExec task is finalized and process the generated randomness.
						Within the <i>receiveResult</i> function use the <i>_iexecDoracleGetVerifiedResult</i> function to verify the iExec task ID is valid and confirm the proper iExec settings were used.
						Use <i>_iexecDoracleUpdateSettings</i> to update the appropriate app and task settings that <i>_iexecDoracleGetVerifiedResult</i> will verify on-chain.
						A sample smart contract to receive iExec callbacks can be seen <a class="iexec-link" href="https://github.com/iExecBlockchainComputing/iexec-doracle/blob/v5/contracts/example/PriceOracle.sol" target="_blank">here</a>.
					</h3>
					<h3>
						This app uses the Python <a class="iexec-link" href="https://docs.python.org/3/library/secrets.html" target="_blank">secrets</a> module. The secrets module provides access to the most secure source of randomness that an operating system provides.
					</h3>
				</div>
			</div>
		</main>

		<footer>
			<div class="footer-wrapper">

				<div class="footer-left">
					<div>
						<img src="./static/img/github.png"  class="github-logo">
					</div>
					<div>
						<a class="white-link " href="https://github.com/j48/iexec-randomness" target="_blank">
						<h2>/j48</h2>
						</a>
					</div>
				</div>

				<div class="footer-center">
					<div>
						<img src="./static/img/iexec-rlc.png"  class="iexec-logo">
					</div>
					<div>
						<a class="iexec-link" href="https://iexec.dev" target="_blank">
						<h2>/home</h2>
						</a>
					</div>
				</div>

				<div class="footer-right">
					<div>
						<a href="https://medium.com/@j48/building-a-decentralized-random-number-generator-using-iexec-part-1-60167434b60b" target="_blank">
						<img src="./static/img/medium.png" class="medium-logo">
						</a>
					</div>
				</div>

			</div>
		</footer>

		<script type="text/javascript" src="./static/js/app/data.js"></script>
		<script>
			async function init(){
				//load iexec sdk
				let iExecSDK = document.createElement("script");
				iExecSDK.setAttribute("src", "./static/js/iexec/sdk/sdkV6.js");
				document.body.appendChild(iExecSDK);

				const main = await import("./static/js/app/main.js");
				main.loadApp();
				//main.loadSample();
			}

			init();
		</script>

	</body>

</html>

